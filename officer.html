<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Officer Dashboard | EventFlow</title>

    <!-- Meta Tags -->
    <meta name="theme-color" content="#6366f1">
    <link rel="manifest" href="manifest.json">

    <!-- Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Outfit:wght@500;700;800&display=swap"
        rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- QR Scanner Library -->
    <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>

    <style>
        #reader {
            width: 100%;
            background: black;
            border-radius: 1rem;
            overflow: hidden;
        }

        /* Customizing scanner UI */
        #reader__dashboard_section_csr span {
            color: var(--text-muted) !important;
        }

        button {
            cursor: pointer;
        }

        .scan-result-card {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid var(--success);
            padding: 1rem;
            border-radius: 0.5rem;
            margin-top: 1rem;
            display: none;
            text-align: center;
        }

        .scan-error-card {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid var(--danger);
            padding: 1rem;
            border-radius: 0.5rem;
            margin-top: 1rem;
            display: none;
            text-align: center;
            color: var(--danger);
        }
    </style>
</head>

<body>

    <!-- Auth Loader -->
    <div id="auth-loader"
        style="position: fixed; inset: 0; background: var(--bg-dark); z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; color: var(--text-muted);">
        <i class="fa-solid fa-circle-notch fa-spin"
            style="font-size: 3rem; color: var(--primary); margin-bottom: 1rem;"></i>
        <p>Verifying Access...</p>
    </div>

    <!-- Navbar -->
    <nav class="navbar hidden" id="main-nav">
        <div class="container nav-container">
            <a href="#" class="logo">
                <i class="fa-solid fa-id-card-clip"></i> Officer Portal
            </a>
            <div class="nav-links">
                <button id="btn-logout" class="btn btn-danger" title="Sign Out">
                    <i class="fa-solid fa-right-from-bracket"></i>
                </button>
            </div>
        </div>
    </nav>

    <main class="container hidden" id="main-content" style="max-width: 600px;">

        <div class="glass-panel mb-4" style="text-align: center; padding: 2rem;">
            <h1 style="margin-bottom: 0.5rem;">Ticket Scanner</h1>
            <p style="color: var(--text-muted);">Scan student tickets to mark attendance.</p>
            <div
                style="margin-top: 1rem; display: inline-block; background: rgba(255,255,255,0.1); padding: 0.5rem 1rem; border-radius: 2rem;">
                <span style="color: var(--text-muted); font-size: 0.9rem;">Session Scans:</span>
                <span id="session-count"
                    style="color: var(--primary); font-weight: bold; font-size: 1.1rem; margin-left: 0.5rem;">0</span>
            </div>
        </div>

        <div class="glass-panel" style="padding: 1rem;">
            <div id="reader"></div>

            <div id="scan-success" class="scan-result-card">
                <i class="fa-solid fa-circle-check"
                    style="font-size: 3rem; color: var(--success); margin-bottom: 0.5rem;"></i>
                <h3 style="color: var(--success);">Verified!</h3>
                <p id="student-name" style="font-weight: bold; font-size: 1.2rem; margin: 0.5rem 0;">Student Name</p>
                <p id="event-name" style="color: var(--text-muted);">Event Name</p>
                <div style="margin-top: 0.5rem; font-size: 0.8rem; opacity: 0.8;">
                    Ticket ID: <span id="ticket-id-display"></span>
                </div>
            </div>

            <div id="scan-error" class="scan-error-card">
                <i class="fa-solid fa-circle-xmark" style="font-size: 2rem; margin-bottom: 0.5rem;"></i>
                <p id="error-text">Invalid Ticket</p>
            </div>

            <div style="text-align: center; margin-top: 1.5rem;">
                <p style="font-size: 0.8rem; color: var(--text-muted);">
                    Ensure scanned code is a valid JSON ticket object.
                </p>
            </div>
        </div>

        <!-- Recent Scans List -->
        <div class="glass-panel mt-4" style="padding: 1.5rem; margin-top: 1.5rem;">
            <h3 style="margin-bottom: 1rem; border-bottom: 1px solid var(--glass-border); padding-bottom: 0.5rem;">
                Recent Scans</h3>
            <div id="recent-scans-list" style="max-height: 300px; overflow-y: auto;">
                <p style="text-align: center; color: var(--text-muted); font-size: 0.9rem;" id="no-scans-msg">No scans
                    yet in this session.</p>
                <!-- Scans injected here -->
            </div>
        </div>

    </main>

    <!-- Scripts -->
    <script src="js/utils.js"></script>
    <script type="module" src="js/officer.js"></script>
</body>

</html>